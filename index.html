<!DOCTYPE html>
<html lang="ja">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>入力フォーム</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./index.css">
    <style>
        /* ヘッダータイル */
        .header-career {
            background-color: #fcac04;
        }
        .header-quest {
            background-color: #3498db;
        }
        .logo {
            color: #fff;
        }
        .title-career hr {
            border-top: 8px solid #fcac04;
        }
        .title-quest hr {
            border-top: 8px solid #3498db;
        }
    </style>
    <!-- デバッグのためのスタイル -->
    <style>
        .debug-info {
            background-color: #ffeeee;
            color: #ff0000;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ff0000;
            border-radius: 5px;
        }
    </style>
</head>

<body>
    <!-- ヘッダー1（キャリアスタディ用） -->
    <header id="header-career" class="header-career">
        <div class="header-block">
            <p class="logo">キャリアスタディ</p>
        </div>
    </header>
    
    <!-- ヘッダー2（完了後アンケート用） -->
    <header id="header-quest" class="header-quest" style="display: none;">
        <div class="header-block">
            <p class="logo">完了後アンケート</p>
        </div>
    </header>
    
    <div class="contents">
        <div id="title-career" class="title title-career">
            <p>情報調査フォーム</p>
            <hr>
        </div>
        <div id="title-quest" class="title title-quest" style="display: none;">
            <p>完了後アンケート</p>
            <hr>
        </div>
    </div>
    
    <!-- デバッグ情報表示エリア -->
    <div id="debug-container" class="debug-info" style="display: none;">
        <h4>デバッグ情報</h4>
        <div id="debug-content"></div>
    </div>
    
    <!-- ローディング表示 -->
    <div id="loading">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
        <p>読み込み中...</p>
    </div>
    
    <!-- フォームコンテナ -->
    <div id="form-container" style="display: none;">
        <!-- フォーム内容はJSで動的に生成 -->
    </div>
    
    <!-- 隠しフィールド（イベント選択用） -->
    <input type="hidden" id="form_answer22" name="event_choice1" value="">
    <input type="hidden" id="form_answer23" name="event_choice2" value="">
    
    <!-- JavaScript読み込み -->
    <script>
        // LIFFのSDKロード状態を確認するためのバックアップコード
        window.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                if (typeof liff === 'undefined') {
                    // LIFFが読み込まれていない場合、エラーを表示
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('debug-container').style.display = 'block';
                    document.getElementById('debug-content').innerHTML = 
                        '<p>LIFF SDKが正しく読み込まれていません。エラーログを確認してください。</p>' +
                        '<p>SDKのステータス: ' + (typeof liff) + '</p>' +
                        '<button class="btn btn-warning" onclick="reloadPage()">再読み込み</button>';
                }
            }, 3000);
        });
        
        // ページを再読み込みする関数
        function reloadPage() {
            location.reload();
        }
        
        // デバッグ情報を表示する関数
        function showDebugInfo(message) {
            console.log('[DEBUG]', message);
            document.getElementById('debug-container').style.display = 'block';
            document.getElementById('debug-content').innerHTML += '<p>' + message + '</p>';
        }
    </script>
    
    <!-- LIFF SDK (必須) -->
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    
    <!-- アプリケーションスクリプト -->
    <script src="./debug.js"></script>
    <script src="./common/utils.js"></script>
    <!-- 生年月日セレクトボックス初期化スクリプト -->
    <script src="./common/birthday.js"></script>
    <script src="./liff.js"></script>
    <script src="./survey1/choices.js"></script>
    <script src="./survey1/form.js"></script>
    <script src="./survey2/form.js"></script>
    <script src="./index.js"></script>
</body>
</html>
